<?php 

//	the common global vars -- these common global vars will load before any js layer or even inline javascript of the wbc, extensions and themes 


//	enqueue common assets 
add_action( ( !is_admin() ? 'wp_enqueue_scripts' : 'admin_enqueue_scripts'),function(){
	
	if( wbc()->sanitize->get('is_test') == 1 ) {
		wbc_pr('js_var_is_loaded');
	}

?>

	<script type="text/javascript">
	
		//	define namespaces 
		window.document.splugins=window.document.splugins||{},window.document.splugins.common=window.document.splugins.common||{},window.document.splugins.admin=window.document.splugins.admin||{};

		<?php 

		if( is_admin() ){

			?>

			window.document.splugins.common.is_admin = <?php echo "true";?>;

			window.document.splugins.admin.is_legacy_admin_page = <?php echo ((apply_filters('sp_is_legacy_admin_page', true)) ? "true" : "false");?>; 
			<?php 
		} else {

			?>
			window.document.splugins.common.is_admin = <?php echo "false";?>;
			<?php
			
		}

		?>

    	window.document.splugins.common.current_theme_key = '<?php echo wbc()->common->current_theme_key(); ?>';
    	
    	window.document.splugins.common.site_url = '<?php echo wbc_site_url(); ?>';

    	window.document.splugins.common.ajax_url = '<?php echo admin_url('admin-ajax.php'); ?>';

		window.document.splugins.common.is_shop_page = <?php echo ((is_shop()) ? "true" : "false");?>; 

		window.document.splugins.common.is_category_page = <?php echo ((is_product_category()) ? "true" : "false");?>; 

		window.document.splugins.common.is_item_page = <?php echo ((is_product()) ? "true" : "false");?>;

		window.document.splugins.common.is_mobile = <?php echo ((wbc_is_mobile()) ? "true" : "false");?>;
		
		window.document.splugins.common.is_tablet = <?php echo ((wbc_is_mobile()) ? "true" : "false");?>;	

		window.document.splugins.common.ajax_url = '<?php echo admin_url('admin-ajax.php');?>';

		window.document.splugins.common.is_nice_urls_enabled = <?php echo ((wbc_is_nice_urls_enabled()) ? "true" : "false");?>;	

		// window.document.splugins.common.ajax_url = '<?php echo admin_url('admin-ajax.php');?>';	
		
		window.document.splugins.common.is_pair_builder = <?php echo ((wbc()->sanitize->get('EO_WBC') == 1) ? "true" : "false");?>;	

	</script>
<?php  
		
	if( is_shop() || is_product_category() || is_product() ) {
	
		// ACTIVE_TODO even though now we are going to use the underscore js but so far it is only by the optionsUI feature so skip loading it here for the rest of features and just put the if condition here for lighter experience to all other users -- to s 
		//	NOTE: below asset will load in footer, so far it is loading from header only because of the chained dependancy on the common js dependancy of the wc-cart variation asset given below 
		wp_enqueue_script('underscore'/*, includes_url('js') . '/underscore.min.js'*/ );	 
		// echo '<script src="'.includes_url('js') . '/underscore.min.js'.'"></script>';
	}

	if (!is_admin()) {
		
		$swatches_configs = array();
		$gallery_images_configs = array();

		$swatches_configs['attribute_types']            = \eo\wbc\model\publics\data_model\SP_WBC_Variations::instance()->sp_variations_swatches_supported_attribute_types(array('is_base_type_only'=>true));
		$swatches_configs['product_variations_configs'] = wbc()->config->product_variations_configs();

	// ACTIVE_TODO admin options need to b loaded from variations.assets.php where b have already prepare all options -- to s 
		$swatches_configs['options'] = array('show_variation_label' => false, 'clickable_out_of_stock' => false);	
		
		$gallery_images_configs['types'] 					  = \eo\wbc\model\publics\data_model\SP_WBC_Variations::instance()->sp_variations_gallery_images_supported_types(array('is_base_type_only'=>true));
		$gallery_images_configs['product_variations_configs'] = wbc()->config->product_variations_configs();
		

		$gallery_images_configs['base_container_selector']    = '.variations_form'/*'.spui-sp-variations-gallery-images'*/;
		$gallery_images_configs['base_container_loop_selector']    = '.variations_form'; //'.spui-sp-variations-loop-gallery-images';

		// for simple type
		$gallery_images_configs['base_container_selector_simple']    =  '.spui-sp-variations-gallery-images-simple';
		$gallery_images_configs['base_container_loop_selector_simple']    = '.spui-sp-variations-loop-gallery-images-simple';

		$gallery_images_configs['template'] 				  = array('slider'=>array('id'=>'sp_slzm_slider_image_loop'), 'zoom'=>array('id'=>'sp_slzm_zoom_image_loop'));	
		$gallery_images_configs['classes'] 				      = array('slider'=>array('container'=>'sp-variations-gallery-images-slider','loop_container'=>'sp-variations-gallery-images-slider-loop'), 'zoom'=>array('container'=>'sp-variations-gallery-images-zoom'));	

		// ACTIVE_TODO we neet to manage the loding secuance here so that any zoom layers including external plugin implimentetion layers can add filter do it 
		$gallery_images_configs['template']['zoom']['all_in_dom'] = apply_filters('sp_slzm_zoom_template_all_in_dom',0);

		// ----loop---	
		$gallery_images_configs['template_loop'] 				  = array('slider'=>array('id'=>'sp_slzm_loop_slider_image_loop'), 'zoom'=>array('id'=>'sp_slzm_loop_zoom_image_loop'));		
		$gallery_images_configs['classes_loop'] 				      = array('slider'=>array('container'=>'sp-variations-loop-gallery-images-slider','loop_container'=>'sp-variations-loop-gallery-images-slider-loop'), 'zoom'=>array('container'=>/*'sp-variations-loop-gallery-images-zoom'*/'#sp_variations_loop_gallery_images_zoom_{product_id}'));		
		// ACTIVE_TODO we neet to manage the loding secuance here so that any zoom layers including external plugin implimentetion layers can add filter do it 	
		$gallery_images_configs['template_loop']['zoom']['all_in_dom'] = apply_filters('sp_slzm_loop_zoom_template_all_in_dom',0);	

		$gallery_images_configs['options'] = array('gallery_reset_on_variation_change'=>false,
																 'tiny_features_option_ui_loop_box_hover_media_index'=>/*wbc()->options->get_option('tiny_features','tiny_features_option_ui_loop_box_hover_media_index','2')*/apply_filters('ssm_vrtns_loop_box_hover_media_type',wbc()->options->get_option('tiny_features','tiny_features_option_ui_loop_box_hover_media_index','2')));

		// ACTIVE_TODO asset enque and other asset flows
			// --  first need to confirm that minified asset only are loaded -- to t
			// --  and also that only necesary and partialy build assets are loaded -- to t 
			// --  ned to make the versions dynamic of assets based on plugin, extensions and themes if there is no other versions system to maintan -- to s & -- to h
		// ACTIVE_TODO/TODO when the variations and its child modules are moved out from the below loaded common js then at that time, also move te wc-cart variation dependancy mentioned below 
		
		if(!is_front_page()){
			$file_suffix = (WBC_SCRIPT_DEBUG) ? '' : '.min';
			wbc()->load->asset('js','common'.$file_suffix,array('jquery','wc-add-to-cart-variation'),"0.1.4",false,true,'common_configs',array('swatches_config'=>$swatches_configs, 'gallery_images_configs'=>$gallery_images_configs),true);
		}

		// ACTIVE_TODO temp. hold for removel and we need to remove as soon as we refactore the loading sequance of filter widget class and load asset function og that class. so it is highly temporary. and we need to fix if we face issues whwrw filter feature is not active on certain pages but still that is loading below asset then we need to prevent that also and other such issues.
		if( is_shop() || is_product_category() ) {
			 $file_suffix = (WBC_SCRIPT_DEBUG) ? '' : '.min';
			 wbc()->load->asset('js', 'publics/eo_wbc_filter'.$file_suffix, array('jquery'), "", false, true, null, null, true);

			// $site_url = get_site_url();
			// $product_url = '';
			// $filter_prefix = '';
			// wbc()->load->asset('js', 'publics/eo_wbc_filter', array( 'eo_wbc_object' => array(
			// 	'eo_product_url'=>$product_url,
			// 	//'eo_view_tabular'=>($current_category=='solitaire'?1:0),
			// 	'disp_regular'=>wbc()->options->get('eo_wbc_e_tabview_status',false)/*get_option('eo_wbc_e_tabview_status',false)*/?1:0,
			// 	'eo_admin_ajax_url'=>admin_url( 'admin-ajax.php'),
			// 	'eo_part_site_url'=>get_site_url().'/index.php',
			// 	'eo_part_end_url'=>'/'.$product_url,
			// 	'eo_cat_site_url'=>$site_url,
			// 	'eo_cat_query'=>http_build_query($_GET),
			// 	'btnfilter_now'=>(empty(wbc()->options->get_option('filters_'.$filter_prefix.'filter_setting','filter_setting_btnfilter_now'))?false:true),
			// 	'btnreset_now'=>(empty(wbc()->options->get_option('filters_'.$filter_prefix.'filter_setting','filter_setting_reset_now'))?false:true),
			// 	'_prefix_' => $filter_prefix,
			// )), "", false, true, null, null, true);
		}
		
	} else {
		if(!is_front_page()){
			$file_suffix = (WBC_SCRIPT_DEBUG) ? '' : '.min';
			wbc()->load->asset('js','common'.$file_suffix,array('jquery'),"0.1.4",false,true);
		}
	}

},( !is_admin() ? 999 : 5) );


add_action('wp_footer',function(){               
   ?>
   	<script>
		//console.log('[js.vars.asset wp_footer]');
    	// //console.log("js.vras.asset outer ready event");
    	
    	jQuery(document).ready(function() {
    		
			(window.document.splugins.common.is_category_page||window.document.splugins.common.is_shop_page)&&"undefined"!=typeof eo_wbc_object&&(window.document.splugins.wbc.pagination.api.init(),window.document.splugins.wbc.filters.api.init(),window.document.splugins.wbc.filter_sets.api.init());

<?php
	   		if (defined('SP_VARIATIONS_LOADED') && SP_VARIATIONS_LOADED == true) { ?>

	   		(window.document.splugins.common.is_item_page||window.document.splugins.common.is_category_page)&&window.document.splugins.wbc.variations.gallery_images.sp_slzm.api.init();

				if(window.document.splugins.common.is_item_page&&(base_container=jQuery(window.document.splugins.common._o(common_configs.gallery_images_configs,"base_container_selector")?common_configs.gallery_images_configs.base_container_selector:".variations_form"),jQuery(base_container).sp_wbc_variations_gallery_images(),base_container_simple=jQuery(window.document.splugins.common._o(common_configs.gallery_images_configs,"base_container_selector_simple")?common_configs.gallery_images_configs.base_container_selector_simple:null),jQuery(base_container_simple).sp_wbc_variations_gallery_images({product_type:"simple"})),window.document.splugins.common.is_category_page){var base_container_loop_feed_page=jQuery(window.document.splugins.common._o(common_configs.gallery_images_configs,"base_container_loop_selector")?common_configs.gallery_images_configs.base_container_loop_selector:".variations_form");jQuery(base_container_loop_feed_page).sp_wbc_variations_gallery_images_feed_page(),jQuery(document).ajaxComplete((function(t,a,i){i.url.indexOf("/product-category/")>=0&&(base_container_loop_feed_page=jQuery(window.document.splugins.common._o(common_configs.gallery_images_configs,"base_container_loop_selector")?common_configs.gallery_images_configs.base_container_loop_selector:".variations_form"),jQuery(base_container_loop_feed_page).sp_wbc_variations_gallery_images_feed_page())}));var base_container_loop_simple_feed_page=jQuery(window.document.splugins.common._o(common_configs.gallery_images_configs,"base_container_loop_selector_simple")?common_configs.gallery_images_configs.base_container_loop_selector_simple:null),loop_simple_feed_page_options={product_type:"simple"};jQuery(base_container_loop_simple_feed_page).sp_wbc_variations_gallery_images_feed_page(loop_simple_feed_page_options),jQuery(document).ajaxComplete((function(t,a,i){i.url.indexOf("/product-category/")>=0&&setTimeout((function(){var t=jQuery(window.document.splugins.common._o(common_configs.gallery_images_configs,"base_container_loop_selector_simple")?common_configs.gallery_images_configs.base_container_loop_selector_simple:null);jQuery(t).sp_wbc_variations_gallery_images_feed_page(loop_simple_feed_page_options)}),500)}))}var base_container_swatches=null;window.document.splugins.common.is_item_page&&(base_container=jQuery(window.document.splugins.common._o(common_configs.swatches_config,"base_container_selector")?common_configs.swatches_config.base_container_selector:".variations_form"),jQuery(base_container).sp_wbc_variations_swatches(),base_container_swatches=base_container),window.document.splugins.common.is_category_page&&(base_container_loop_feed_page=jQuery(window.document.splugins.common._o(common_configs.swatches_config,"base_container_loop_selector")?common_configs.swatches_config.base_container_loop_selector:".variations_form"),jQuery(base_container_loop_feed_page).sp_wbc_variations_swatches_feed_page(),jQuery(document).ajaxComplete((function(t,a,i){i.url.indexOf("/product-category/")>=0&&(base_container_loop_feed_page=jQuery(window.document.splugins.common._o(common_configs.swatches_config,"base_container_loop_selector")?common_configs.swatches_config.base_container_loop_selector:".variations_form"),jQuery(base_container_loop_feed_page).sp_wbc_variations_swatches_feed_page())})),base_container_swatches=base_container_loop_feed_page),jQuery(".variations_form").trigger("check_variations"),window.setTimeout((function(){!function(t,a,i,e){var o=function(t){var a=this;a.$form=t,a.$attributeFields=t.find(".variations select"),a.$singleVariation=t.find(".single_variation"),a.$singleVariationWrap=t.find(".single_variation_wrap"),a.$resetVariations=t.find(".reset_variations"),a.$product=t.closest(".product"),a.variationData=t.data("product_variations"),a.useAjax=!1===a.variationData,a.xhr=!1,a.loading=!0,a.$singleVariationWrap.show(),a.$form.off(".wc-variation-form"),a.getChosenAttributes=a.getChosenAttributes.bind(a),a.findMatchingVariations=a.findMatchingVariations.bind(a),a.isMatch=a.isMatch.bind(a),a.toggleResetLink=a.toggleResetLink.bind(a),t.on("click.wc-variation-form",".reset_variations",{variationForm:a},a.onReset),t.on("reload_product_variations",{variationForm:a},a.onReload),t.on("hide_variation",{variationForm:a},a.onHide),t.on("show_variation",{variationForm:a},a.onShow),t.on("click",".single_add_to_cart_button",{variationForm:a},a.onAddToCart),t.on("reset_data",{variationForm:a},a.onResetDisplayedVariation),t.on("reset_image",{variationForm:a},a.onResetImage),t.on("change.wc-variation-form",".variations select",{variationForm:a},a.onChange),t.on("found_variation.wc-variation-form",{variationForm:a},a.onFoundVariation),t.on("check_variations.wc-variation-form",{variationForm:a},a.onFindVariation),t.on("update_variation_values.wc-variation-form",{variationForm:a},a.onUpdateAttributes),setTimeout((function(){t.trigger("check_variations"),t.trigger("wc_variation_form",a),a.loading=!1}),100)};o.prototype.onReset=function(t){t.preventDefault(),t.data.variationForm.$attributeFields.val("").trigger("change"),t.data.variationForm.$form.trigger("reset_data")},o.prototype.onReload=function(t){var a=t.data.variationForm;a.variationData=a.$form.data("product_variations"),a.useAjax=!1===a.variationData,a.$form.trigger("check_variations")},o.prototype.onHide=function(t){t.preventDefault(),t.data.variationForm.$form.find(".single_add_to_cart_button").removeClass("wc-variation-is-unavailable").addClass("disabled wc-variation-selection-needed"),t.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-enabled").addClass("woocommerce-variation-add-to-cart-disabled")},o.prototype.onShow=function(a,i,e){a.preventDefault(),e?(a.data.variationForm.$form.find(".single_add_to_cart_button").removeClass("disabled wc-variation-selection-needed wc-variation-is-unavailable"),a.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-disabled").addClass("woocommerce-variation-add-to-cart-enabled")):(a.data.variationForm.$form.find(".single_add_to_cart_button").removeClass("wc-variation-selection-needed").addClass("disabled wc-variation-is-unavailable"),a.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-enabled").addClass("woocommerce-variation-add-to-cart-disabled")),wp.mediaelement&&a.data.variationForm.$form.find(".wp-audio-shortcode, .wp-video-shortcode").not(".mejs-container").filter((function(){return!t(this).parent().hasClass("mejs-mediaelement")})).mediaelementplayer(wp.mediaelement.settings)},o.prototype.onAddToCart=function(i){t(this).is(".disabled")&&(i.preventDefault(),t(this).is(".wc-variation-is-unavailable")?a.alert(wc_add_to_cart_variation_params.i18n_unavailable_text):t(this).is(".wc-variation-selection-needed")&&a.alert(wc_add_to_cart_variation_params.i18n_make_a_selection_text))},o.prototype.onResetDisplayedVariation=function(t){var a=t.data.variationForm;a.$product.find(".product_meta").find(".sku").wc_reset_content(),a.$product.find(".product_weight, .woocommerce-product-attributes-item--weight .woocommerce-product-attributes-item__value").wc_reset_content(),a.$product.find(".product_dimensions, .woocommerce-product-attributes-item--dimensions .woocommerce-product-attributes-item__value").wc_reset_content(),a.$form.trigger("reset_image"),a.$singleVariation.slideUp(200).trigger("hide_variation")},o.prototype.onResetImage=function(t){t.data.variationForm.$form.wc_variations_image_update(!1)},o.prototype.onFindVariation=function(a,i){var e=a.data.variationForm,o=void 0!==i?i:e.getChosenAttributes(),r=o.data;if(o.count&&o.count===o.chosenCount)if(e.useAjax)e.xhr&&e.xhr.abort(),e.$form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),r.product_id=parseInt(e.$form.data("product_id"),10),r.custom_data=e.$form.data("custom_data"),e.xhr=t.ajax({url:wc_add_to_cart_variation_params.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:r,success:function(t){t?e.$form.trigger("found_variation",[t]):(e.$form.trigger("reset_data"),o.chosenCount=0,e.loading||(e.$form.find(".single_variation").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),e.$form.find(".wc-no-matching-variations").slideDown(200)))},complete:function(){e.$form.unblock()}});else{e.$form.trigger("update_variation_values");var n=e.findMatchingVariations(e.variationData,r).shift();n?e.$form.trigger("found_variation",[n]):(e.$form.trigger("reset_data"),o.chosenCount=0,e.loading||(e.$form.find(".single_variation").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),e.$form.find(".wc-no-matching-variations").slideDown(200)))}else e.$form.trigger("update_variation_values"),e.$form.trigger("reset_data");e.toggleResetLink(o.chosenCount>0)},o.prototype.onFoundVariation=function(a,i){var e=a.data.variationForm,o=e.$product.find(".product_meta").find(".sku"),n=e.$product.find(".product_weight, .woocommerce-product-attributes-item--weight .woocommerce-product-attributes-item__value"),s=e.$product.find(".product_dimensions, .woocommerce-product-attributes-item--dimensions .woocommerce-product-attributes-item__value"),_=e.$singleVariationWrap.find(".quantity"),c=!0,d=!1,m="";if(i.sku?o.wc_set_content(i.sku):o.wc_reset_content(),i.weight?n.wc_set_content(i.weight_html):n.wc_reset_content(),i.dimensions?s.wc_set_content(t.parseHTML(i.dimensions_html)[0].data):s.wc_reset_content(),e.$form.wc_variations_image_update(i),i.variation_is_visible?(d=r("variation-template"),i.variation_id):d=r("unavailable-variation-template"),m=(m=(m=d({variation:i})).replace("/*<![CDATA[*/","")).replace("/*]]>*/",""),e.$singleVariation.html(m),e.$form.find('input[name="variation_id"], input.variation_id').val(i.variation_id).trigger("change"),"yes"===i.is_sold_individually)_.find("input.qty").val("1").attr("min","1").attr("max","").trigger("change"),_.hide();else{var l=_.find("input.qty"),g=parseFloat(l.val());g=isNaN(g)||(g=g>parseFloat(i.max_qty)?i.max_qty:g)<parseFloat(i.min_qty)?i.min_qty:g,l.attr("min",i.min_qty).attr("max",i.max_qty).val(g).trigger("change"),_.show()}i.is_purchasable&&i.is_in_stock&&i.variation_is_visible||(c=!1),e.$singleVariation.text().trim()?e.$singleVariation.slideDown(200).trigger("show_variation",[i,c]):e.$singleVariation.show().trigger("show_variation",[i,c])},o.prototype.onChange=function(t){var a=t.data.variationForm;a.$form.find('input[name="variation_id"], input.variation_id').val("").trigger("change"),a.$form.find(".wc-no-matching-variations").remove(),a.useAjax||a.$form.trigger("woocommerce_variation_select_change"),a.$form.trigger("check_variations"),a.$form.trigger("woocommerce_variation_has_changed")},o.prototype.addSlashes=function(t){return t=(t=t.replace(/'/g,"\\'")).replace(/"/g,'\\"')},o.prototype.onUpdateAttributes=function(a){var i=a.data.variationForm,e=i.getChosenAttributes().data;i.useAjax||(i.$attributeFields.each((function(a,o){var r,n=t(o),s=n.data("attribute_name")||n.attr("name"),_=t(o).data("show_option_none"),c=":gt(0)",d=t("<select/>"),m=n.val()||"",l=!0;if(!n.data("attribute_html")){var g=n.clone();g.find("option").removeAttr("attached").prop("disabled",!1).prop("selected",!1),n.data("attribute_options",g.find("option"+c).get()),n.data("attribute_html",g.html())}d.html(n.data("attribute_html"));var v=t.extend(!0,{},e);v[s]="";var f=i.findMatchingVariations(i.variationData,v);for(var u in f)if(void 0!==f[u]){var p=f[u].attributes;for(var h in p)if(p.hasOwnProperty(h)){var w=p[h],b="";if(h===s)if(f[u].variation_is_active&&(b="enabled"),w){w=t("<div/>").html(w).text();var y=d.find("option");if(y.length)for(var $=0,F=y.length;$<F;$++){var x=t(y[$]);if(w===x.val()){x.addClass("attached "+b);break}}}else d.find("option:gt(0)").addClass("attached "+b)}}r=d.find("option.attached").length,m&&(l=!1,0!==r&&d.find("option.attached.enabled").each((function(){var a=t(this).val();if(m===a)return l=!0,!1}))),r>0&&m&&l&&"no"===_&&(d.find("option:first").remove(),c=""),d.find("option"+c+":not(.attached)").remove(),n.html(d.html()),n.find("option"+c+":not(.enabled)").prop("disabled",!0),m?l?n.val(m):n.val("").trigger("change"):n.val("")})),i.$form.trigger("woocommerce_update_variation_values"))},o.prototype.getChosenAttributes=function(){var a={},i=0,e=0;return this.$attributeFields.each((function(){var o=t(this).data("attribute_name")||t(this).attr("name"),r=t(this).val()||"";r.length>0&&e++,i++,a[o]=r})),{count:i,chosenCount:e,data:a}},o.prototype.findMatchingVariations=function(t,a){for(var i=[],e=0;e<t.length;e++){var o=t[e];this.isMatch(o.attributes,a)&&i.push(o)}return i},o.prototype.isMatch=function(t,a){var i=!0;for(var o in t)if(t.hasOwnProperty(o)){var r=t[o],n=a[o];r!==e&&n!==e&&0!==r.length&&0!==n.length&&r!==n&&(i=!1)}return i},o.prototype.toggleResetLink=function(t){t?"hidden"===this.$resetVariations.css("visibility")&&this.$resetVariations.css("visibility","visible").hide().fadeIn():this.$resetVariations.css("visibility","hidden")},t.fn.wc_variation_form=function(){return new o(this),this},t.fn.wc_set_content=function(t){e===this.attr("data-o_content")&&this.attr("data-o_content",this.text()),this.text(t)},t.fn.wc_reset_content=function(){e!==this.attr("data-o_content")&&this.text(this.attr("data-o_content"))},t.fn.wc_set_variation_attr=function(t,a){e===this.attr("data-o_"+t)&&this.attr("data-o_"+t,this.attr(t)?this.attr(t):""),!1===a?this.removeAttr(t):this.attr(t,a)},t.fn.wc_reset_variation_attr=function(t){e!==this.attr("data-o_"+t)&&this.attr(t,this.attr("data-o_"+t))},t.fn.wc_maybe_trigger_slide_position_reset=function(a){var i=t(this),e=i.closest(".product").find(".images"),o=!1,r=a&&a.image_id?a.image_id:"";i.attr("current-image")!==r&&(o=!0),i.attr("current-image",r),o&&e.trigger("woocommerce_gallery_reset_slide_position")},t.fn.wc_variations_image_update=function(i){var e=this,o=e.closest(".product"),r=o.find(".images"),n=o.find(".flex-control-nav"),s=n.find("li:eq(0) img"),_=r.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),c=_.find(".wp-post-image"),d=_.find("a").eq(0);if(i&&i.image&&i.image.src&&i.image.src.length>1){n.find('li img[data-o_src="'+i.image.gallery_thumbnail_src+'"]').length>0&&e.wc_variations_image_reset();var m=n.find('li img[src="'+i.image.gallery_thumbnail_src+'"]');if(m.length>0)return m.trigger("click"),e.attr("current-image",i.image_id),void a.setTimeout((function(){t(a).trigger("resize"),r.trigger("woocommerce_gallery_init_zoom")}),20);c.wc_set_variation_attr("src",i.image.src),c.wc_set_variation_attr("height",i.image.src_h),c.wc_set_variation_attr("width",i.image.src_w),c.wc_set_variation_attr("srcset",i.image.srcset),c.wc_set_variation_attr("sizes",i.image.sizes),c.wc_set_variation_attr("title",i.image.title),c.wc_set_variation_attr("data-caption",i.image.caption),c.wc_set_variation_attr("alt",i.image.alt),c.wc_set_variation_attr("data-src",i.image.full_src),c.wc_set_variation_attr("data-large_image",i.image.full_src),c.wc_set_variation_attr("data-large_image_width",i.image.full_src_w),c.wc_set_variation_attr("data-large_image_height",i.image.full_src_h),_.wc_set_variation_attr("data-thumb",i.image.src),s.wc_set_variation_attr("src",i.image.gallery_thumbnail_src),d.wc_set_variation_attr("href",i.image.full_src)}else e.wc_variations_image_reset();a.setTimeout((function(){t(a).trigger("resize"),e.wc_maybe_trigger_slide_position_reset(i),r.trigger("woocommerce_gallery_init_zoom")}),20)},t.fn.wc_variations_image_reset=function(){var t=this.closest(".product"),a=t.find(".images"),i=t.find(".flex-control-nav").find("li:eq(0) img"),e=a.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),o=e.find(".wp-post-image"),r=e.find("a").eq(0);o.wc_reset_variation_attr("src"),o.wc_reset_variation_attr("width"),o.wc_reset_variation_attr("height"),o.wc_reset_variation_attr("srcset"),o.wc_reset_variation_attr("sizes"),o.wc_reset_variation_attr("title"),o.wc_reset_variation_attr("data-caption"),o.wc_reset_variation_attr("alt"),o.wc_reset_variation_attr("data-src"),o.wc_reset_variation_attr("data-large_image"),o.wc_reset_variation_attr("data-large_image_width"),o.wc_reset_variation_attr("data-large_image_height"),e.wc_reset_variation_attr("data-thumb"),i.wc_reset_variation_attr("src"),r.wc_reset_variation_attr("href")},t((function(){"undefined"!=typeof wc_add_to_cart_variation_params&&t(".variations_form").each((function(){t(this).wc_variation_form()}))}));var r=function(t){var e=i.getElementById("tmpl-"+t).textContent,o=!1;return(o=(o=(o=o||/<#\s?data\./.test(e))||/{{{?\s?data\.(?!variation\.).+}}}?/.test(e))||/{{{?\s?data\.variation\.[\w-]*[^\s}]/.test(e))?wp.template(t):function(t){var i=t.variation||{};return e.replace(/({{{?)\s?data\.variation\.([\w-]*)\s?(}}}?)/g,(function(t,e,o,r){if(e.length!==r.length)return"";var n=i[o]||"";return 2===e.length?a.escape(n):n}))}}}(jQuery,window,document)}),1e3),jQuery(document).ajaxComplete((function(t,a,i){i.url.indexOf("/product-category/")>=0&&window.setTimeout((function(){!function(t,a,i,e){var o=function(t){var a=this;a.$form=t,a.$attributeFields=t.find(".variations select"),a.$singleVariation=t.find(".single_variation"),a.$singleVariationWrap=t.find(".single_variation_wrap"),a.$resetVariations=t.find(".reset_variations"),a.$product=t.closest(".product"),a.variationData=t.data("product_variations"),a.useAjax=!1===a.variationData,a.xhr=!1,a.loading=!0,a.$singleVariationWrap.show(),a.$form.off(".wc-variation-form"),a.getChosenAttributes=a.getChosenAttributes.bind(a),a.findMatchingVariations=a.findMatchingVariations.bind(a),a.isMatch=a.isMatch.bind(a),a.toggleResetLink=a.toggleResetLink.bind(a),t.on("click.wc-variation-form",".reset_variations",{variationForm:a},a.onReset),t.on("reload_product_variations",{variationForm:a},a.onReload),t.on("hide_variation",{variationForm:a},a.onHide),t.on("show_variation",{variationForm:a},a.onShow),t.on("click",".single_add_to_cart_button",{variationForm:a},a.onAddToCart),t.on("reset_data",{variationForm:a},a.onResetDisplayedVariation),t.on("reset_image",{variationForm:a},a.onResetImage),t.on("change.wc-variation-form",".variations select",{variationForm:a},a.onChange),t.on("found_variation.wc-variation-form",{variationForm:a},a.onFoundVariation),t.on("check_variations.wc-variation-form",{variationForm:a},a.onFindVariation),t.on("update_variation_values.wc-variation-form",{variationForm:a},a.onUpdateAttributes),setTimeout((function(){t.trigger("check_variations"),t.trigger("wc_variation_form",a),a.loading=!1}),100)};o.prototype.onReset=function(t){t.preventDefault(),t.data.variationForm.$attributeFields.val("").trigger("change"),t.data.variationForm.$form.trigger("reset_data")},o.prototype.onReload=function(t){var a=t.data.variationForm;a.variationData=a.$form.data("product_variations"),a.useAjax=!1===a.variationData,a.$form.trigger("check_variations")},o.prototype.onHide=function(t){t.preventDefault(),t.data.variationForm.$form.find(".single_add_to_cart_button").removeClass("wc-variation-is-unavailable").addClass("disabled wc-variation-selection-needed"),t.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-enabled").addClass("woocommerce-variation-add-to-cart-disabled")},o.prototype.onShow=function(a,i,e){a.preventDefault(),e?(a.data.variationForm.$form.find(".single_add_to_cart_button").removeClass("disabled wc-variation-selection-needed wc-variation-is-unavailable"),a.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-disabled").addClass("woocommerce-variation-add-to-cart-enabled")):(a.data.variationForm.$form.find(".single_add_to_cart_button").removeClass("wc-variation-selection-needed").addClass("disabled wc-variation-is-unavailable"),a.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-enabled").addClass("woocommerce-variation-add-to-cart-disabled")),wp.mediaelement&&a.data.variationForm.$form.find(".wp-audio-shortcode, .wp-video-shortcode").not(".mejs-container").filter((function(){return!t(this).parent().hasClass("mejs-mediaelement")})).mediaelementplayer(wp.mediaelement.settings)},o.prototype.onAddToCart=function(i){t(this).is(".disabled")&&(i.preventDefault(),t(this).is(".wc-variation-is-unavailable")?a.alert(wc_add_to_cart_variation_params.i18n_unavailable_text):t(this).is(".wc-variation-selection-needed")&&a.alert(wc_add_to_cart_variation_params.i18n_make_a_selection_text))},o.prototype.onResetDisplayedVariation=function(t){var a=t.data.variationForm;a.$product.find(".product_meta").find(".sku").wc_reset_content(),a.$product.find(".product_weight, .woocommerce-product-attributes-item--weight .woocommerce-product-attributes-item__value").wc_reset_content(),a.$product.find(".product_dimensions, .woocommerce-product-attributes-item--dimensions .woocommerce-product-attributes-item__value").wc_reset_content(),a.$form.trigger("reset_image"),a.$singleVariation.slideUp(200).trigger("hide_variation")},o.prototype.onResetImage=function(t){t.data.variationForm.$form.wc_variations_image_update(!1)},o.prototype.onFindVariation=function(a,i){var e=a.data.variationForm,o=void 0!==i?i:e.getChosenAttributes(),r=o.data;if(o.count&&o.count===o.chosenCount)if(e.useAjax)e.xhr&&e.xhr.abort(),e.$form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),r.product_id=parseInt(e.$form.data("product_id"),10),r.custom_data=e.$form.data("custom_data"),e.xhr=t.ajax({url:wc_add_to_cart_variation_params.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:r,success:function(t){t?e.$form.trigger("found_variation",[t]):(e.$form.trigger("reset_data"),o.chosenCount=0,e.loading||(e.$form.find(".single_variation").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),e.$form.find(".wc-no-matching-variations").slideDown(200)))},complete:function(){e.$form.unblock()}});else{e.$form.trigger("update_variation_values");var n=e.findMatchingVariations(e.variationData,r).shift();n?e.$form.trigger("found_variation",[n]):(e.$form.trigger("reset_data"),o.chosenCount=0,e.loading||(e.$form.find(".single_variation").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),e.$form.find(".wc-no-matching-variations").slideDown(200)))}else e.$form.trigger("update_variation_values"),e.$form.trigger("reset_data");e.toggleResetLink(o.chosenCount>0)},o.prototype.onFoundVariation=function(a,i){var e=a.data.variationForm,o=e.$product.find(".product_meta").find(".sku"),n=e.$product.find(".product_weight, .woocommerce-product-attributes-item--weight .woocommerce-product-attributes-item__value"),s=e.$product.find(".product_dimensions, .woocommerce-product-attributes-item--dimensions .woocommerce-product-attributes-item__value"),_=e.$singleVariationWrap.find(".quantity"),c=!0,d=!1,m="";if(i.sku?o.wc_set_content(i.sku):o.wc_reset_content(),i.weight?n.wc_set_content(i.weight_html):n.wc_reset_content(),i.dimensions?s.wc_set_content(t.parseHTML(i.dimensions_html)[0].data):s.wc_reset_content(),e.$form.wc_variations_image_update(i),i.variation_is_visible?(d=r("variation-template"),i.variation_id):d=r("unavailable-variation-template"),m=(m=(m=d({variation:i})).replace("/*<![CDATA[*/","")).replace("/*]]>*/",""),e.$singleVariation.html(m),e.$form.find('input[name="variation_id"], input.variation_id').val(i.variation_id).trigger("change"),"yes"===i.is_sold_individually)_.find("input.qty").val("1").attr("min","1").attr("max","").trigger("change"),_.hide();else{var l=_.find("input.qty"),g=parseFloat(l.val());g=isNaN(g)||(g=g>parseFloat(i.max_qty)?i.max_qty:g)<parseFloat(i.min_qty)?i.min_qty:g,l.attr("min",i.min_qty).attr("max",i.max_qty).val(g).trigger("change"),_.show()}i.is_purchasable&&i.is_in_stock&&i.variation_is_visible||(c=!1),e.$singleVariation.text().trim()?e.$singleVariation.slideDown(200).trigger("show_variation",[i,c]):e.$singleVariation.show().trigger("show_variation",[i,c])},o.prototype.onChange=function(t){var a=t.data.variationForm;a.$form.find('input[name="variation_id"], input.variation_id').val("").trigger("change"),a.$form.find(".wc-no-matching-variations").remove(),a.useAjax||a.$form.trigger("woocommerce_variation_select_change"),a.$form.trigger("check_variations"),a.$form.trigger("woocommerce_variation_has_changed")},o.prototype.addSlashes=function(t){return t=(t=t.replace(/'/g,"\\'")).replace(/"/g,'\\"')},o.prototype.onUpdateAttributes=function(a){var i=a.data.variationForm,e=i.getChosenAttributes().data;i.useAjax||(i.$attributeFields.each((function(a,o){var r,n=t(o),s=n.data("attribute_name")||n.attr("name"),_=t(o).data("show_option_none"),c=":gt(0)",d=t("<select/>"),m=n.val()||"",l=!0;if(!n.data("attribute_html")){var g=n.clone();g.find("option").removeAttr("attached").prop("disabled",!1).prop("selected",!1),n.data("attribute_options",g.find("option"+c).get()),n.data("attribute_html",g.html())}d.html(n.data("attribute_html"));var v=t.extend(!0,{},e);v[s]="";var f=i.findMatchingVariations(i.variationData,v);for(var u in f)if(void 0!==f[u]){var p=f[u].attributes;for(var h in p)if(p.hasOwnProperty(h)){var w=p[h],b="";if(h===s)if(f[u].variation_is_active&&(b="enabled"),w){w=t("<div/>").html(w).text();var y=d.find("option");if(y.length)for(var $=0,F=y.length;$<F;$++){var x=t(y[$]);if(w===x.val()){x.addClass("attached "+b);break}}}else d.find("option:gt(0)").addClass("attached "+b)}}r=d.find("option.attached").length,m&&(l=!1,0!==r&&d.find("option.attached.enabled").each((function(){var a=t(this).val();if(m===a)return l=!0,!1}))),r>0&&m&&l&&"no"===_&&(d.find("option:first").remove(),c=""),d.find("option"+c+":not(.attached)").remove(),n.html(d.html()),n.find("option"+c+":not(.enabled)").prop("disabled",!0),m?l?n.val(m):n.val("").trigger("change"):n.val("")})),i.$form.trigger("woocommerce_update_variation_values"))},o.prototype.getChosenAttributes=function(){var a={},i=0,e=0;return this.$attributeFields.each((function(){var o=t(this).data("attribute_name")||t(this).attr("name"),r=t(this).val()||"";r.length>0&&e++,i++,a[o]=r})),{count:i,chosenCount:e,data:a}},o.prototype.findMatchingVariations=function(t,a){for(var i=[],e=0;e<t.length;e++){var o=t[e];this.isMatch(o.attributes,a)&&i.push(o)}return i},o.prototype.isMatch=function(t,a){var i=!0;for(var o in t)if(t.hasOwnProperty(o)){var r=t[o],n=a[o];r!==e&&n!==e&&0!==r.length&&0!==n.length&&r!==n&&(i=!1)}return i},o.prototype.toggleResetLink=function(t){t?"hidden"===this.$resetVariations.css("visibility")&&this.$resetVariations.css("visibility","visible").hide().fadeIn():this.$resetVariations.css("visibility","hidden")},t.fn.wc_variation_form=function(){return new o(this),this},t.fn.wc_set_content=function(t){e===this.attr("data-o_content")&&this.attr("data-o_content",this.text()),this.text(t)},t.fn.wc_reset_content=function(){e!==this.attr("data-o_content")&&this.text(this.attr("data-o_content"))},t.fn.wc_set_variation_attr=function(t,a){e===this.attr("data-o_"+t)&&this.attr("data-o_"+t,this.attr(t)?this.attr(t):""),!1===a?this.removeAttr(t):this.attr(t,a)},t.fn.wc_reset_variation_attr=function(t){e!==this.attr("data-o_"+t)&&this.attr(t,this.attr("data-o_"+t))},t.fn.wc_maybe_trigger_slide_position_reset=function(a){var i=t(this),e=i.closest(".product").find(".images"),o=!1,r=a&&a.image_id?a.image_id:"";i.attr("current-image")!==r&&(o=!0),i.attr("current-image",r),o&&e.trigger("woocommerce_gallery_reset_slide_position")},t.fn.wc_variations_image_update=function(i){var e=this,o=e.closest(".product"),r=o.find(".images"),n=o.find(".flex-control-nav"),s=n.find("li:eq(0) img"),_=r.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),c=_.find(".wp-post-image"),d=_.find("a").eq(0);if(i&&i.image&&i.image.src&&i.image.src.length>1){n.find('li img[data-o_src="'+i.image.gallery_thumbnail_src+'"]').length>0&&e.wc_variations_image_reset();var m=n.find('li img[src="'+i.image.gallery_thumbnail_src+'"]');if(m.length>0)return m.trigger("click"),e.attr("current-image",i.image_id),void a.setTimeout((function(){t(a).trigger("resize"),r.trigger("woocommerce_gallery_init_zoom")}),20);c.wc_set_variation_attr("src",i.image.src),c.wc_set_variation_attr("height",i.image.src_h),c.wc_set_variation_attr("width",i.image.src_w),c.wc_set_variation_attr("srcset",i.image.srcset),c.wc_set_variation_attr("sizes",i.image.sizes),c.wc_set_variation_attr("title",i.image.title),c.wc_set_variation_attr("data-caption",i.image.caption),c.wc_set_variation_attr("alt",i.image.alt),c.wc_set_variation_attr("data-src",i.image.full_src),c.wc_set_variation_attr("data-large_image",i.image.full_src),c.wc_set_variation_attr("data-large_image_width",i.image.full_src_w),c.wc_set_variation_attr("data-large_image_height",i.image.full_src_h),_.wc_set_variation_attr("data-thumb",i.image.src),s.wc_set_variation_attr("src",i.image.gallery_thumbnail_src),d.wc_set_variation_attr("href",i.image.full_src)}else e.wc_variations_image_reset();a.setTimeout((function(){t(a).trigger("resize"),e.wc_maybe_trigger_slide_position_reset(i),r.trigger("woocommerce_gallery_init_zoom")}),20)},t.fn.wc_variations_image_reset=function(){var t=this.closest(".product"),a=t.find(".images"),i=t.find(".flex-control-nav").find("li:eq(0) img"),e=a.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),o=e.find(".wp-post-image"),r=e.find("a").eq(0);o.wc_reset_variation_attr("src"),o.wc_reset_variation_attr("width"),o.wc_reset_variation_attr("height"),o.wc_reset_variation_attr("srcset"),o.wc_reset_variation_attr("sizes"),o.wc_reset_variation_attr("title"),o.wc_reset_variation_attr("data-caption"),o.wc_reset_variation_attr("alt"),o.wc_reset_variation_attr("data-src"),o.wc_reset_variation_attr("data-large_image"),o.wc_reset_variation_attr("data-large_image_width"),o.wc_reset_variation_attr("data-large_image_height"),e.wc_reset_variation_attr("data-thumb"),i.wc_reset_variation_attr("src"),r.wc_reset_variation_attr("href")},t((function(){"undefined"!=typeof wc_add_to_cart_variation_params&&t(".variations_form").each((function(){t(this).wc_variation_form()}))}));var r=function(t){var e=i.getElementById("tmpl-"+t).textContent,o=!1;return(o=(o=(o=o||/<#\s?data\./.test(e))||/{{{?\s?data\.(?!variation\.).+}}}?/.test(e))||/{{{?\s?data\.variation\.[\w-]*[^\s}]/.test(e))?wp.template(t):function(t){var i=t.variation||{};return e.replace(/({{{?)\s?data\.variation\.([\w-]*)\s?(}}}?)/g,(function(t,e,o,r){if(e.length!==r.length)return"";var n=i[o]||"";return 2===e.length?a.escape(n):n}))}}}(jQuery,window,document)}),1e3)}));
<?php	    	
			} ?>
		});
   	</script>    
  <?php      
}, PHP_INT_MAX);

?>
